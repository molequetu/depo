2018-11-16 13:57:12.667 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 13:57:12.731 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 13:57:12.733 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 13:57:12.734 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 13:57:12.734 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:04:50.739 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 17:04:50.777 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 17:04:50.777 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 17:04:50.777 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 17:04:50.777 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:04:50.921 +02:00 [DBG] Starting token cleanup
2018-11-16 17:04:57.379 +02:00 [DBG] Stopping token cleanup
2018-11-16 17:04:57.380 +02:00 [DBG] TaskCanceledException. Exiting.
2018-11-16 17:05:02.722 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 17:05:02.759 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 17:05:02.759 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 17:05:02.760 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 17:05:02.760 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:05:02.900 +02:00 [DBG] Starting token cleanup
2018-11-16 17:05:12.055 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:05:12.063 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:05:12.063 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:05:12.135 +02:00 [DBG] Start discovery request
2018-11-16 17:05:13.081 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:06:06.321 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 17:06:06.361 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 17:06:06.361 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 17:06:06.361 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 17:06:06.361 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:06:06.614 +02:00 [DBG] Starting token cleanup
2018-11-16 17:09:10.105 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 17:09:10.156 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 17:09:10.157 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 17:09:10.157 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 17:09:10.157 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:09:10.690 +02:00 [DBG] Starting token cleanup
2018-11-16 17:10:21.781 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:10:22.374 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:10:22.382 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:10:22.477 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:10:22.480 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:10:22.481 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:10:22.484 +02:00 [DBG] Start discovery request
2018-11-16 17:10:23.107 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:10:23.272 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-16 17:10:23.286 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-16 17:10:23.286 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-16 17:10:23.291 +02:00 [DBG] Start authorize request
2018-11-16 17:10:23.303 +02:00 [DBG] No user present in authorize request
2018-11-16 17:10:23.308 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:10:23.434 +02:00 [DBG] js found in database: false
2018-11-16 17:10:23.463 +02:00 [ERR] Unknown client or not enabled: js
{
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "63ddd4b53dc14dfa94a42f77f88bc6e6",
    "nonce": "f3001cd8fdd9417da71d15b888229c7d"
  }
}
2018-11-16 17:10:23.468 +02:00 [ERR] Request validation failed
2018-11-16 17:10:23.468 +02:00 [INF] {
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "js",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "63ddd4b53dc14dfa94a42f77f88bc6e6",
    "nonce": "f3001cd8fdd9417da71d15b888229c7d"
  }
}
2018-11-16 17:10:23.507 +02:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "js",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ActivityId": "0HLIBQLR7RGCF:00000002",
  "TimeStamp": "2018-11-16T15:10:23Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:11:54.803 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:11:54.818 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:11:54.818 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:11:54.818 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:11:54.818 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:11:54.819 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:11:54.819 +02:00 [DBG] Start discovery request
2018-11-16 17:11:54.823 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:11:54.838 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-16 17:11:54.839 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-16 17:11:54.839 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-16 17:11:54.839 +02:00 [DBG] Start authorize request
2018-11-16 17:11:54.839 +02:00 [DBG] No user present in authorize request
2018-11-16 17:11:54.839 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:11:55.081 +02:00 [DBG] spa found in database: true
2018-11-16 17:11:55.134 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:11:55.195 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:11:55.214 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:11:55.217 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:11:55.228 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:11:55.230 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "1604da85c80a48fd88bfab37d997acf3",
  "Nonce": "59c8babe73c04dc2bcd28c1c4a2043ff",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "1604da85c80a48fd88bfab37d997acf3",
    "nonce": "59c8babe73c04dc2bcd28c1c4a2043ff"
  }
}
2018-11-16 17:11:55.241 +02:00 [INF] Showing login: User is not authenticated
2018-11-16 17:11:55.319 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:11:55.325 +02:00 [DBG] spa found in database: true
2018-11-16 17:11:55.327 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:11:55.330 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:11:55.332 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:11:55.335 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:11:55.335 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:11:55.345 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.554 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-16 17:12:09.630 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:09.634 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.637 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.641 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.643 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.646 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.647 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:09.654 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIBQLR7RGCM:00000002",
  "TimeStamp": "2018-11-16T15:12:09Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:12:09.678 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:12:09.680 +02:00 [DBG] Adding idp claim with value: local
2018-11-16 17:12:09.680 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-16 17:12:09.693 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:12:09.697 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.710 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:09.710 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:09.710 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-16 17:12:09.711 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-16 17:12:09.711 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-16 17:12:09.718 +02:00 [DBG] Start authorize callback request
2018-11-16 17:12:09.736 +02:00 [DBG] User in authorize request: 818727
2018-11-16 17:12:09.736 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:09.740 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.743 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.746 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.747 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.750 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.750 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:09.751 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "1604da85c80a48fd88bfab37d997acf3",
  "Nonce": "59c8babe73c04dc2bcd28c1c4a2043ff",
  "SessionId": "729364cd2e5c8ed892c204cd2e0f4144",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "1604da85c80a48fd88bfab37d997acf3",
    "nonce": "59c8babe73c04dc2bcd28c1c4a2043ff"
  }
}
2018-11-16 17:12:09.752 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-16 17:12:09.799 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-16 17:12:09.799 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-16 17:12:09.800 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-16 17:12:09.800 +02:00 [INF] Showing consent: User has not yet consented
2018-11-16 17:12:09.811 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:09.811 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:09.857 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:09.861 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.863 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.866 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.868 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.871 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:09.871 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:09.874 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:09.877 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:09.879 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:10.318 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.318 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.318 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.318 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.318 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.319 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.344 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.344 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.452 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.454 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.502 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.502 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.589 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:10.590 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:20.334 +02:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-16 17:12:20.335 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:20.335 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:20.438 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:20.442 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:20.445 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:20.448 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:20.450 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:20.453 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:20.453 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:20.464 +02:00 [INF] {
  "Name": "Consent granted",
  "Category": "Grants",
  "EventType": "Information",
  "Id": 4000,
  "SubjectId": "818727",
  "ClientId": "spa",
  "RequestedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "GrantedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ConsentRemembered": true,
  "ActivityId": "0HLIBQLR7RGCM:00000004",
  "TimeStamp": "2018-11-16T15:12:20Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:12:20.481 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:20.491 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:20.492 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:20.492 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-16 17:12:20.492 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-16 17:12:20.492 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-16 17:12:20.492 +02:00 [DBG] Start authorize callback request
2018-11-16 17:12:20.502 +02:00 [DBG] User in authorize request: 818727
2018-11-16 17:12:20.502 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:20.511 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:20.514 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:20.518 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:20.520 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:20.524 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:20.524 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:20.525 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "1604da85c80a48fd88bfab37d997acf3",
  "Nonce": "59c8babe73c04dc2bcd28c1c4a2043ff",
  "SessionId": "729364cd2e5c8ed892c204cd2e0f4144",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "1604da85c80a48fd88bfab37d997acf3",
    "nonce": "59c8babe73c04dc2bcd28c1c4a2043ff"
  }
}
2018-11-16 17:12:20.525 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-16 17:12:20.528 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-16 17:12:20.528 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-16 17:12:20.528 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-16 17:12:20.535 +02:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-11-16 17:12:20.537 +02:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-11-16 17:12:20.543 +02:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2018-11-16 17:12:20.561 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= not found in database
2018-11-16 17:12:20.767 +02:00 [DBG] Creating Implicit Flow response.
2018-11-16 17:12:20.783 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-16 17:12:20.783 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-16 17:12:20.789 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-16 17:12:20.791 +02:00 [DBG] Issued claims: []
2018-11-16 17:12:20.907 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-16 17:12:20.907 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-16 17:12:20.926 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****54Jg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****3ZwQ"
    }
  ],
  "ActivityId": "0HLIBQLR7RGCL:00000005",
  "TimeStamp": "2018-11-16T15:12:20Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:12:20.930 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "1604da85c80a48fd88bfab37d997acf3",
  "Scope": "openid profile api1"
}
2018-11-16 17:12:20.950 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:12:20.951 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:12:59.382 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.382 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.420 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:12:59.426 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:59.430 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:59.433 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:59.438 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:59.442 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:59.442 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:12:59.446 +02:00 [DBG] spa found in database: true
2018-11-16 17:12:59.448 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:12:59.454 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:12:59.524 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.524 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.527 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.533 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.563 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.564 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.564 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.564 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.697 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.699 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.899 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:12:59.899 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:00.024 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:00.025 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:02.830 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:02.830 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.116 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.116 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.116 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.116 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.162 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.163 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.167 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.199 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.315 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.315 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.426 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.426 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.564 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:03.564 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.367 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.367 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.471 +02:00 [DBG] 1 persisted grants found for 818727
2018-11-16 17:13:05.498 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:05.502 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:05.506 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:05.740 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.740 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.747 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.748 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.787 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.787 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.789 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.790 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.896 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:05.896 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:06.132 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:06.132 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.748 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.748 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.831 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.831 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.831 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.831 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.874 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.874 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.894 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:11.894 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.090 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.090 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.090 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.090 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.142 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:12.143 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.237 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.238 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.484 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.484 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.498 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.498 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.497 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.526 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.622 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.623 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.627 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.628 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.824 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:13.824 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:15.313 +02:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-16 17:13:15.313 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:15.313 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:15.364 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-16 17:13:15.370 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIBQLR7RGCO:00000003",
  "TimeStamp": "2018-11-16T15:13:15Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:13:15.722 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-16 17:13:15.727 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-16 17:13:15.728 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-16 17:13:15.800 +02:00 [DBG] Processing signout callback request
2018-11-16 17:13:15.839 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:15.839 +02:00 [DBG] No client front-channel logout URLs
2018-11-16 17:13:15.840 +02:00 [DBG] No client back-channel logout URLs
2018-11-16 17:13:15.840 +02:00 [INF] Successful signout callback.
2018-11-16 17:13:15.840 +02:00 [DBG] No client front-channel iframe urls
2018-11-16 17:13:15.840 +02:00 [DBG] No client back-channel iframe urls
2018-11-16 17:13:20.788 +02:00 [INF] AuthenticationScheme: idsrv was challenged.
2018-11-16 17:13:51.261 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:13:51.264 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:13:51.264 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:13:51.265 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:13:51.265 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:13:51.265 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:13:51.265 +02:00 [DBG] Start discovery request
2018-11-16 17:13:51.270 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:13:51.288 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-16 17:13:51.288 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-16 17:13:51.289 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-16 17:13:51.289 +02:00 [DBG] Start authorize request
2018-11-16 17:13:51.289 +02:00 [DBG] No user present in authorize request
2018-11-16 17:13:51.289 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:13:51.294 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:51.297 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:51.302 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:51.304 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:51.308 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:51.308 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:13:51.308 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "7964b7660a544fb4b6faac011f1032c9",
  "Nonce": "223fa666ab5e403e8133750c9e8ac648",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "7964b7660a544fb4b6faac011f1032c9",
    "nonce": "223fa666ab5e403e8133750c9e8ac648"
  }
}
2018-11-16 17:13:51.308 +02:00 [INF] Showing login: User is not authenticated
2018-11-16 17:13:51.353 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:13:51.358 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:51.361 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:51.364 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:51.367 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:51.371 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:51.371 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:13:51.375 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:57.773 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-16 17:13:57.869 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:13:57.873 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:57.881 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:57.890 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:57.895 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:57.907 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:57.907 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:13:57.908 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIBQLR7RGCO:0000000A",
  "TimeStamp": "2018-11-16T15:13:57Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:13:57.908 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:13:57.908 +02:00 [DBG] Adding idp claim with value: local
2018-11-16 17:13:57.908 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-16 17:13:57.908 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:13:57.913 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:57.971 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:57.972 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:13:57.972 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-16 17:13:57.973 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-16 17:13:57.973 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-16 17:13:57.973 +02:00 [DBG] Start authorize callback request
2018-11-16 17:13:57.973 +02:00 [DBG] User in authorize request: 818727
2018-11-16 17:13:57.973 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:13:57.978 +02:00 [DBG] spa found in database: true
2018-11-16 17:13:57.982 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:57.987 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:57.990 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:13:57.994 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:13:57.994 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:13:57.994 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "7964b7660a544fb4b6faac011f1032c9",
  "Nonce": "223fa666ab5e403e8133750c9e8ac648",
  "SessionId": "ac1becd5b6254b45bffbd672607a6c10",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "7964b7660a544fb4b6faac011f1032c9",
    "nonce": "223fa666ab5e403e8133750c9e8ac648"
  }
}
2018-11-16 17:13:57.994 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-16 17:13:57.998 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-16 17:13:58.006 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-16 17:13:58.006 +02:00 [DBG] Creating Implicit Flow response.
2018-11-16 17:13:58.006 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-16 17:13:58.006 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-16 17:13:58.006 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-16 17:13:58.006 +02:00 [DBG] Issued claims: []
2018-11-16 17:13:58.010 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-16 17:13:58.011 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-16 17:13:58.016 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****oeSQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****JUSw"
    }
  ],
  "ActivityId": "0HLIBQLR7RGCL:00000015",
  "TimeStamp": "2018-11-16T15:13:58Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:13:58.016 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "7964b7660a544fb4b6faac011f1032c9",
  "Scope": "openid profile api1"
}
2018-11-16 17:13:58.016 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:13:58.017 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:13:59.687 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:13:59.690 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:13:59.690 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:13:59.690 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:13:59.691 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:13:59.691 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:13:59.691 +02:00 [DBG] Start discovery request
2018-11-16 17:13:59.697 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:14:00.003 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-16 17:14:00.008 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:14:00.008 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:14:00.008 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-16 17:14:00.009 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-16 17:14:00.009 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-16 17:14:00.013 +02:00 [DBG] Start key discovery request
2018-11-16 17:14:00.310 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-16 17:14:00.320 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:14:00.321 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:14:00.592 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-16 17:14:00.599 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:14:00.599 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:14:00.599 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-16 17:14:00.600 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-16 17:14:00.600 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-16 17:14:00.618 +02:00 [DBG] Start userinfo request
2018-11-16 17:14:00.624 +02:00 [DBG] Bearer token found in header
2018-11-16 17:14:00.771 +02:00 [DBG] spa found in database: true
2018-11-16 17:14:00.786 +02:00 [DBG] spa found in database: true
2018-11-16 17:14:00.788 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-16 17:14:00.791 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-16 17:14:00.799 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542381238,
    "exp": 1542384838,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542381237,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-16 17:14:00.801 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-16 17:14:00.810 +02:00 [DBG] Creating userinfo response
2018-11-16 17:14:00.817 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:14:00.823 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:14:00.837 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:14:00.839 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-16 17:14:00.839 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:14:00.852 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:14:00.853 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-16 17:14:00.856 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-16 17:14:00.856 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-16 17:14:00.857 +02:00 [DBG] End userinfo request
2018-11-16 17:14:00.985 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:00.985 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:00.985 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-16 17:14:00.986 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-16 17:14:00.986 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-16 17:14:00.987 +02:00 [DBG] Rendering check session result
2018-11-16 17:14:02.139 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:14:02.260 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:14:02.260 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:14:02.260 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:14:02.260 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:14:02.260 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:14:02.260 +02:00 [DBG] Start discovery request
2018-11-16 17:14:02.285 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:14:02.561 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:02.561 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:02.561 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-16 17:14:02.562 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-16 17:14:02.562 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-16 17:14:02.562 +02:00 [DBG] Rendering check session result
2018-11-16 17:14:14.063 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:14:14.063 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:14:14.063 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:14:14.063 +02:00 [DBG] Start discovery request
2018-11-16 17:14:14.069 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:14:14.232 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-16 17:14:14.232 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-16 17:14:14.232 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-16 17:14:14.232 +02:00 [DBG] Start key discovery request
2018-11-16 17:14:23.687 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:23.687 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:23.687 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-16 17:14:23.688 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-16 17:14:23.688 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-16 17:14:23.698 +02:00 [DBG] Processing signout request for 818727
2018-11-16 17:14:23.706 +02:00 [DBG] Start end session request validation
2018-11-16 17:14:23.715 +02:00 [DBG] Start identity token validation
2018-11-16 17:14:23.720 +02:00 [DBG] spa found in database: true
2018-11-16 17:14:23.720 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-16 17:14:23.723 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-16 17:14:23.723 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-16 17:14:23.723 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542381238,
    "exp": 1542381538,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "223fa666ab5e403e8133750c9e8ac648",
    "iat": 1542381238,
    "at_hash": "cm1E4vEeoTUH_dq5xRofCw",
    "sid": "ac1becd5b6254b45bffbd672607a6c10",
    "sub": "818727",
    "auth_time": 1542381237,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-16 17:14:23.729 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDIzODEyMzgsImV4cCI6MTU0MjM4MTUzOCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiIyMjNmYTY2NmFiNWU0MDNlODEzMzc1MGM5ZThhYzY0OCIsImlhdCI6MTU0MjM4MTIzOCwiYXRfaGFzaCI6ImNtMUU0dkVlb1RVSF9kcTV4Um9mQ3ciLCJzaWQiOiJhYzFiZWNkNWI2MjU0YjQ1YmZmYmQ2NzI2MDdhNmMxMCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjM4MTIzNywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.IEt-jGET41Cjmup8gDl0_mcr7_M05XWwSACXJICu8b1_IR2_9nJfoR0txASFPbqsfv49oDHTrSwxFk9L2G18oGzOaAADND1xGaAgUZ19ray0ciM3lA5gotM_5gq6Qeqx90BS0jhT9GZcz5mWCyFof5D_xoqF1nGHZOdtKkTloIOMj9FQU7XZaiNjzEG2rarQPvSU2nLgOV5cdMQvUdxo0mKDrK1qPcGLoDaVe9EZ_S7Oa2Ds30WL_5bDBbKyp04JeYPXoX9zv-dzDNUVTCiXRq5aV5EbxY-vJ6pXsKP3yHC3xFSxGgG-Cvqb_PNoVdFTSWb-R1XtyEjC6pCpAWoeSQ",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-16 17:14:23.730 +02:00 [DBG] Success validating end session request from spa
2018-11-16 17:14:23.754 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:23.754 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:14:23.790 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-16 17:14:23.791 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIBQLR7RGCK:0000001B",
  "TimeStamp": "2018-11-16T15:14:23Z",
  "ProcessId": 14992,
  "LocalIpAddress": "127.0.0.1:15812",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:14:24.033 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-16 17:14:24.034 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-16 17:14:24.034 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-16 17:14:24.034 +02:00 [DBG] Processing signout callback request
2018-11-16 17:14:24.075 +02:00 [DBG] spa found in database: true
2018-11-16 17:14:24.075 +02:00 [DBG] No client front-channel logout URLs
2018-11-16 17:14:24.075 +02:00 [DBG] No client back-channel logout URLs
2018-11-16 17:14:24.075 +02:00 [INF] Successful signout callback.
2018-11-16 17:14:24.075 +02:00 [DBG] No client front-channel iframe urls
2018-11-16 17:14:24.075 +02:00 [DBG] No client back-channel iframe urls
2018-11-16 17:51:33.991 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-16 17:51:34.035 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-16 17:51:34.035 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-16 17:51:34.036 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-16 17:51:34.036 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-16 17:51:34.351 +02:00 [DBG] Starting token cleanup
2018-11-16 17:52:00.118 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:52:00.616 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:00.622 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:00.701 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:52:00.706 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:52:00.706 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:52:00.710 +02:00 [DBG] Start discovery request
2018-11-16 17:52:01.298 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:52:01.435 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-16 17:52:01.463 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-16 17:52:01.463 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-16 17:52:01.468 +02:00 [DBG] Start authorize request
2018-11-16 17:52:01.494 +02:00 [DBG] No user present in authorize request
2018-11-16 17:52:01.508 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:52:01.876 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:01.917 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:01.962 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:01.981 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:01.984 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:01.995 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:52:02.026 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "1d52c24a14d6441aa26e55d8f2072793",
  "Nonce": "1fdab66d16fd4435b4bab6c2bb60cc92",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "1d52c24a14d6441aa26e55d8f2072793",
    "nonce": "1fdab66d16fd4435b4bab6c2bb60cc92"
  }
}
2018-11-16 17:52:02.035 +02:00 [INF] Showing login: User is not authenticated
2018-11-16 17:52:02.266 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:52:02.271 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:02.274 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:02.277 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:02.280 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:02.283 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:02.283 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:52:02.290 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:08.227 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-16 17:52:08.317 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:52:08.322 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:08.326 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:08.329 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:08.331 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:08.334 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:08.334 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:52:08.376 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIBRDHAADO5:00000005",
  "TimeStamp": "2018-11-16T15:52:08Z",
  "ProcessId": 7084,
  "LocalIpAddress": "127.0.0.1:18140",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:52:08.393 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:52:08.396 +02:00 [DBG] Adding idp claim with value: local
2018-11-16 17:52:08.396 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-16 17:52:08.411 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:52:08.415 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:08.427 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:08.427 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:08.427 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-16 17:52:08.428 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-16 17:52:08.428 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-16 17:52:08.435 +02:00 [DBG] Start authorize callback request
2018-11-16 17:52:08.442 +02:00 [DBG] User in authorize request: 818727
2018-11-16 17:52:08.442 +02:00 [DBG] Start authorize request protocol validation
2018-11-16 17:52:08.446 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:08.448 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:08.451 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:08.454 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:08.459 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-16 17:52:08.459 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-16 17:52:08.460 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "1d52c24a14d6441aa26e55d8f2072793",
  "Nonce": "1fdab66d16fd4435b4bab6c2bb60cc92",
  "SessionId": "4cf9347b77b658e56b07116b631070c6",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "1d52c24a14d6441aa26e55d8f2072793",
    "nonce": "1fdab66d16fd4435b4bab6c2bb60cc92"
  }
}
2018-11-16 17:52:08.461 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-16 17:52:08.573 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-16 17:52:08.594 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-16 17:52:08.602 +02:00 [DBG] Creating Implicit Flow response.
2018-11-16 17:52:08.615 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-16 17:52:08.616 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-16 17:52:08.620 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-16 17:52:08.623 +02:00 [DBG] Issued claims: []
2018-11-16 17:52:08.726 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-16 17:52:08.726 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-16 17:52:08.745 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****DTPw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****R3KA"
    }
  ],
  "ActivityId": "0HLIBRDHAADO8:00000002",
  "TimeStamp": "2018-11-16T15:52:08Z",
  "ProcessId": 7084,
  "LocalIpAddress": "127.0.0.1:18140",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:52:08.749 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "1d52c24a14d6441aa26e55d8f2072793",
  "Scope": "openid profile api1"
}
2018-11-16 17:52:08.768 +02:00 [DBG] Augmenting SignInContext
2018-11-16 17:52:08.768 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-16 17:52:08.986 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:52:08.989 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:08.989 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:08.990 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:52:08.990 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:52:08.990 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:52:08.990 +02:00 [DBG] Start discovery request
2018-11-16 17:52:08.995 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:52:09.018 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-16 17:52:09.019 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:09.019 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:09.020 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-16 17:52:09.020 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-16 17:52:09.021 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-16 17:52:09.025 +02:00 [DBG] Start key discovery request
2018-11-16 17:52:09.096 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-16 17:52:09.098 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:09.098 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:09.117 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-16 17:52:09.119 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:09.119 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:09.119 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-16 17:52:09.122 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-16 17:52:09.122 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-16 17:52:09.129 +02:00 [DBG] Start userinfo request
2018-11-16 17:52:09.133 +02:00 [DBG] Bearer token found in header
2018-11-16 17:52:09.224 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:09.231 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:09.232 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-16 17:52:09.232 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-16 17:52:09.236 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542383528,
    "exp": 1542387128,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542383528,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-16 17:52:09.238 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-16 17:52:09.244 +02:00 [DBG] Creating userinfo response
2018-11-16 17:52:09.249 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:52:09.252 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:52:09.258 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:09.258 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-16 17:52:09.258 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-16 17:52:09.260 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-16 17:52:09.260 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-16 17:52:09.262 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-16 17:52:09.262 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-16 17:52:09.262 +02:00 [DBG] End userinfo request
2018-11-16 17:52:09.283 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:09.283 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:09.283 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-16 17:52:09.284 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-16 17:52:09.284 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-16 17:52:09.285 +02:00 [DBG] Rendering check session result
2018-11-16 17:52:09.454 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-16 17:52:09.456 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-16 17:52:09.456 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-16 17:52:09.456 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:52:09.456 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:52:09.456 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:52:09.456 +02:00 [DBG] Start discovery request
2018-11-16 17:52:09.461 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:52:09.530 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:09.530 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:09.530 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-16 17:52:09.531 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-16 17:52:09.531 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-16 17:52:09.531 +02:00 [DBG] Rendering check session result
2018-11-16 17:52:11.164 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-16 17:52:11.164 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-16 17:52:11.164 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-16 17:52:11.164 +02:00 [DBG] Start discovery request
2018-11-16 17:52:11.169 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-16 17:52:11.306 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-16 17:52:11.306 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-16 17:52:11.306 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-16 17:52:11.306 +02:00 [DBG] Start key discovery request
2018-11-16 17:52:12.536 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:12.536 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:12.536 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-16 17:52:12.537 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-16 17:52:12.537 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-16 17:52:12.543 +02:00 [DBG] Processing signout request for 818727
2018-11-16 17:52:12.552 +02:00 [DBG] Start end session request validation
2018-11-16 17:52:12.559 +02:00 [DBG] Start identity token validation
2018-11-16 17:52:12.565 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:12.565 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-16 17:52:12.567 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-16 17:52:12.567 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-16 17:52:12.567 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542383528,
    "exp": 1542383828,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "1fdab66d16fd4435b4bab6c2bb60cc92",
    "iat": 1542383528,
    "at_hash": "QJisYIt0I_e62f3wyPw_Uw",
    "sid": "4cf9347b77b658e56b07116b631070c6",
    "sub": "818727",
    "auth_time": 1542383528,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-16 17:52:12.574 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDIzODM1MjgsImV4cCI6MTU0MjM4MzgyOCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiIxZmRhYjY2ZDE2ZmQ0NDM1YjRiYWI2YzJiYjYwY2M5MiIsImlhdCI6MTU0MjM4MzUyOCwiYXRfaGFzaCI6IlFKaXNZSXQwSV9lNjJmM3d5UHdfVXciLCJzaWQiOiI0Y2Y5MzQ3Yjc3YjY1OGU1NmIwNzExNmI2MzEwNzBjNiIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjM4MzUyOCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.jsF_oKk0YQuE79296N1bvRFhBgBX4VMhmqfac0r4BnE-rwhPzeHn6IdS3uwxBPtlyDaBT8eIK28vXRuTwD9H7R0YjmcHJC0nY-cTN33AjxF6gmt4YuTzqhXisdY3P5u6Nwab8tN5KvYHT1nBsWgqCzUJ6rvXmeEMTRXT51fVuFQtJIt0t9SPw2oVcLs0P0-9t-vSK7DDXdW0oIsuGJ-jNwDokjMBsZdzkK6ap4tty-ieRO2qKq3IDX4HsGgYC3YxRu2z2lvS33FTKq089ReV0Pxz77jiBBeAiLXJT2cECXQR9cqzcRp9bUwcK8mCy07iXyrJN_Gzx6esDgY0xNDTPw",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-16 17:52:12.575 +02:00 [DBG] Success validating end session request from spa
2018-11-16 17:52:12.612 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:12.612 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-16 17:52:12.695 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-16 17:52:12.700 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIBRDHAADO5:00000008",
  "TimeStamp": "2018-11-16T15:52:12Z",
  "ProcessId": 7084,
  "LocalIpAddress": "127.0.0.1:18140",
  "RemoteIpAddress": "::1"
}
2018-11-16 17:52:12.960 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-16 17:52:12.961 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-16 17:52:12.962 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-16 17:52:12.967 +02:00 [DBG] Processing signout callback request
2018-11-16 17:52:12.985 +02:00 [DBG] spa found in database: true
2018-11-16 17:52:12.985 +02:00 [DBG] No client front-channel logout URLs
2018-11-16 17:52:12.985 +02:00 [DBG] No client back-channel logout URLs
2018-11-16 17:52:12.985 +02:00 [INF] Successful signout callback.
2018-11-16 17:52:12.985 +02:00 [DBG] No client front-channel iframe urls
2018-11-16 17:52:12.985 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 14:54:31.871 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 14:54:31.914 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 14:54:31.915 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 14:54:31.915 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 14:54:31.916 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 14:54:32.467 +02:00 [DBG] Starting token cleanup
2018-11-18 14:54:41.419 +02:00 [DBG] Stopping token cleanup
2018-11-18 14:54:41.422 +02:00 [DBG] TaskCanceledException. Exiting.
2018-11-18 14:54:50.690 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 14:54:50.725 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 14:54:50.726 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 14:54:50.726 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 14:54:50.727 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 14:54:51.178 +02:00 [DBG] Starting token cleanup
2018-11-18 14:54:51.708 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:54:53.421 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:54:53.429 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:54:53.601 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:54:53.606 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:54:53.607 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:54:53.613 +02:00 [DBG] Start discovery request
2018-11-18 14:54:55.197 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:54:55.692 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 14:54:55.707 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 14:54:55.707 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 14:54:55.712 +02:00 [DBG] Start authorize request
2018-11-18 14:54:55.746 +02:00 [DBG] No user present in authorize request
2018-11-18 14:54:55.756 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:54:56.386 +02:00 [DBG] spa found in database: true
2018-11-18 14:54:56.477 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:54:56.551 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:54:56.582 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:54:56.590 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:54:56.607 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:54:56.641 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "924e3b06699f43ffb5a1d8eb94189f56",
  "Nonce": "4aba95186b97449aa66e50305ef6d6aa",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "924e3b06699f43ffb5a1d8eb94189f56",
    "nonce": "4aba95186b97449aa66e50305ef6d6aa"
  }
}
2018-11-18 14:54:56.659 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 14:54:57.285 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:54:57.299 +02:00 [DBG] spa found in database: true
2018-11-18 14:54:57.309 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:54:57.314 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:54:57.320 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:54:57.326 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:54:57.326 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:54:57.339 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:09.877 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:55:10.075 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:10.085 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:10.090 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:10.096 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:10.102 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:10.107 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:10.107 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:10.156 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAK3P1FQA:00000004",
  "TimeStamp": "2018-11-18T12:55:10Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:10.187 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:10.190 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 14:55:10.190 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 14:55:10.256 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:10.265 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:10.420 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:10.422 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:10.422 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 14:55:10.423 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 14:55:10.424 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 14:55:10.437 +02:00 [DBG] Start authorize callback request
2018-11-18 14:55:10.444 +02:00 [DBG] User in authorize request: 818727
2018-11-18 14:55:10.444 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:10.452 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:10.457 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:10.465 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:10.470 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:10.475 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:10.476 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:10.476 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "924e3b06699f43ffb5a1d8eb94189f56",
  "Nonce": "4aba95186b97449aa66e50305ef6d6aa",
  "SessionId": "2b1e95baf45ed50289fa36f4a24b06ed",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "924e3b06699f43ffb5a1d8eb94189f56",
    "nonce": "4aba95186b97449aa66e50305ef6d6aa"
  }
}
2018-11-18 14:55:10.479 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 14:55:10.579 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-18 14:55:10.601 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-18 14:55:10.610 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 14:55:10.626 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 14:55:10.626 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 14:55:10.632 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 14:55:10.634 +02:00 [DBG] Issued claims: []
2018-11-18 14:55:10.734 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 14:55:10.734 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 14:55:10.758 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****1oPw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****pCLw"
    }
  ],
  "ActivityId": "0HLIDAK3P1FQA:00000005",
  "TimeStamp": "2018-11-18T12:55:10Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:10.765 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "924e3b06699f43ffb5a1d8eb94189f56",
  "Scope": "openid profile api1"
}
2018-11-18 14:55:10.797 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:10.798 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:12.372 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:55:12.380 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:12.380 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:12.380 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:12.381 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:12.381 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:12.381 +02:00 [DBG] Start discovery request
2018-11-18 14:55:12.393 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:12.508 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 14:55:12.513 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:12.513 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:12.514 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 14:55:12.514 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 14:55:12.514 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 14:55:12.524 +02:00 [DBG] Start key discovery request
2018-11-18 14:55:12.795 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:55:12.799 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:12.799 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:12.834 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:55:12.837 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:12.837 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:12.838 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 14:55:12.841 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 14:55:12.841 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 14:55:12.862 +02:00 [DBG] Start userinfo request
2018-11-18 14:55:12.869 +02:00 [DBG] Bearer token found in header
2018-11-18 14:55:13.052 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:13.064 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:13.067 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 14:55:13.067 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 14:55:13.076 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542545710,
    "exp": 1542549310,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542545710,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 14:55:13.079 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 14:55:13.091 +02:00 [DBG] Creating userinfo response
2018-11-18 14:55:13.100 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:13.105 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:13.115 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:13.117 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 14:55:13.117 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:13.121 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:13.122 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 14:55:13.125 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 14:55:13.125 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 14:55:13.126 +02:00 [DBG] End userinfo request
2018-11-18 14:55:13.649 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:55:13.653 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:13.654 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:13.654 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:13.654 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:13.654 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:13.654 +02:00 [DBG] Start discovery request
2018-11-18 14:55:13.664 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:13.760 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:13.760 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:13.760 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 14:55:13.761 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 14:55:13.761 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 14:55:13.764 +02:00 [DBG] Rendering check session result
2018-11-18 14:55:18.086 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:18.087 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:18.087 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:18.087 +02:00 [DBG] Start discovery request
2018-11-18 14:55:18.097 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:18.215 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 14:55:18.215 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 14:55:18.216 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 14:55:18.216 +02:00 [DBG] Start key discovery request
2018-11-18 14:55:24.291 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.297 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.298 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 14:55:24.302 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 14:55:24.303 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 14:55:24.320 +02:00 [DBG] Processing signout request for 818727
2018-11-18 14:55:24.332 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.332 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.340 +02:00 [DBG] Start end session request validation
2018-11-18 14:55:24.370 +02:00 [DBG] Start identity token validation
2018-11-18 14:55:24.386 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:24.387 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 14:55:24.392 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 14:55:24.392 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 14:55:24.393 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542545710,
    "exp": 1542546010,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "4aba95186b97449aa66e50305ef6d6aa",
    "iat": 1542545710,
    "at_hash": "_Uejc7Pm0mkVChJ8LTUKsg",
    "sid": "2b1e95baf45ed50289fa36f4a24b06ed",
    "sub": "818727",
    "auth_time": 1542545710,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 14:55:24.407 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDU3MTAsImV4cCI6MTU0MjU0NjAxMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiI0YWJhOTUxODZiOTc0NDlhYTY2ZTUwMzA1ZWY2ZDZhYSIsImlhdCI6MTU0MjU0NTcxMCwiYXRfaGFzaCI6Il9VZWpjN1BtMG1rVkNoSjhMVFVLc2ciLCJzaWQiOiIyYjFlOTViYWY0NWVkNTAyODlmYTM2ZjRhMjRiMDZlZCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0NTcxMCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.HKWYvGSUEfNW5bDNu5cuxoHbzSYAO2i6wS28wTtooMWoI645IZ-XFQrq1OvX3DO_VHVMUUZc96NIVpDu20z1ANTuAMeXYEUmTny3msl_5POPeifUbvv1lM4pqR0PLNdwSlukbncenUsZtrRWaEqjpHTaQ5VItWAnaLOM5gx8bKM4yVU9luqknKIGdA0ipn3SqI-5hF77ASdnisMYzz-EJ8hh7tnfJv4AsxKQrNZJ7-P5SKFCoEigwlZHQ0s01V5FO8ngFMO35vSXZDuUoamcu3itLADSgfxI2toIhIxfZTk43dNtZ0J_cGUpna0OsIXOssJNQiwS8V57g3ICCA1oPw",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 14:55:24.407 +02:00 [DBG] Success validating end session request from spa
2018-11-18 14:55:24.439 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.439 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:24.546 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 14:55:24.553 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAK3P1FQB:00000002",
  "TimeStamp": "2018-11-18T12:55:24Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:25.151 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 14:55:25.159 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 14:55:25.159 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 14:55:25.172 +02:00 [DBG] Processing signout callback request
2018-11-18 14:55:25.215 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:25.216 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 14:55:25.217 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 14:55:25.217 +02:00 [INF] Successful signout callback.
2018-11-18 14:55:25.217 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 14:55:25.217 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 14:55:29.885 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:55:29.889 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:29.889 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:29.890 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:29.890 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:29.890 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:29.890 +02:00 [DBG] Start discovery request
2018-11-18 14:55:29.899 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:29.927 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 14:55:29.928 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 14:55:29.928 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 14:55:29.928 +02:00 [DBG] Start authorize request
2018-11-18 14:55:29.928 +02:00 [DBG] No user present in authorize request
2018-11-18 14:55:29.929 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:29.941 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:29.945 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:29.958 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:29.962 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:29.973 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:29.973 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:29.973 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e6a539b117c042c082f463f7bab09e75",
  "Nonce": "b61f1ae904764892bd87131e17677577",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e6a539b117c042c082f463f7bab09e75",
    "nonce": "b61f1ae904764892bd87131e17677577"
  }
}
2018-11-18 14:55:29.973 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 14:55:29.993 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:29.999 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:30.006 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:30.012 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:30.018 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:30.026 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:30.026 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:30.035 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:31.795 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:55:31.807 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:31.820 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:31.830 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:31.844 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:31.850 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:31.860 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:31.861 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:31.861 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAK3P1FQA:00000011",
  "TimeStamp": "2018-11-18T12:55:31Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:31.861 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:31.861 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 14:55:31.861 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 14:55:31.862 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:31.872 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:31.892 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:31.892 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:31.892 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 14:55:31.893 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 14:55:31.893 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 14:55:31.893 +02:00 [DBG] Start authorize callback request
2018-11-18 14:55:31.894 +02:00 [DBG] User in authorize request: 818727
2018-11-18 14:55:31.894 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:55:31.908 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:31.914 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:31.924 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:31.928 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:31.942 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:31.942 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:55:31.942 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e6a539b117c042c082f463f7bab09e75",
  "Nonce": "b61f1ae904764892bd87131e17677577",
  "SessionId": "e4bdf2c8df31655fce9e476e000c857c",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e6a539b117c042c082f463f7bab09e75",
    "nonce": "b61f1ae904764892bd87131e17677577"
  }
}
2018-11-18 14:55:31.942 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 14:55:31.947 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-18 14:55:31.959 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-18 14:55:31.959 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 14:55:31.959 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 14:55:31.959 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 14:55:31.959 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 14:55:31.959 +02:00 [DBG] Issued claims: []
2018-11-18 14:55:31.966 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 14:55:31.967 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 14:55:31.973 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****eb5Q"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****n6Ew"
    }
  ],
  "ActivityId": "0HLIDAK3P1FQB:00000005",
  "TimeStamp": "2018-11-18T12:55:31Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:31.973 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "e6a539b117c042c082f463f7bab09e75",
  "Scope": "openid profile api1"
}
2018-11-18 14:55:31.973 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:31.974 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:32.396 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:55:32.417 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:32.424 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:32.425 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:32.426 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:32.426 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:32.426 +02:00 [DBG] Start discovery request
2018-11-18 14:55:32.442 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:32.661 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 14:55:32.665 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:32.666 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:32.666 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 14:55:32.666 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 14:55:32.667 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 14:55:32.667 +02:00 [DBG] Start key discovery request
2018-11-18 14:55:32.835 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:55:32.842 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:32.842 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:32.878 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:55:32.882 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:32.883 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:32.883 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 14:55:32.884 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 14:55:32.884 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 14:55:32.884 +02:00 [DBG] Start userinfo request
2018-11-18 14:55:32.884 +02:00 [DBG] Bearer token found in header
2018-11-18 14:55:32.911 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:32.918 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:32.919 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 14:55:32.919 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 14:55:32.920 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542545731,
    "exp": 1542549331,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542545731,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 14:55:32.920 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 14:55:32.920 +02:00 [DBG] Creating userinfo response
2018-11-18 14:55:32.920 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:32.921 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:32.926 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:32.926 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 14:55:32.926 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:55:32.930 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:32.931 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 14:55:32.931 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 14:55:32.931 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 14:55:32.931 +02:00 [DBG] End userinfo request
2018-11-18 14:55:33.523 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:55:33.528 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:55:33.528 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:55:33.528 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:55:33.529 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:55:33.529 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:55:33.529 +02:00 [DBG] Start discovery request
2018-11-18 14:55:33.537 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:55:33.633 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:33.634 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:33.634 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 14:55:33.635 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 14:55:33.635 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 14:55:33.635 +02:00 [DBG] Rendering check session result
2018-11-18 14:55:35.345 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:35.347 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:35.347 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 14:55:35.348 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 14:55:35.348 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 14:55:35.348 +02:00 [DBG] Processing signout request for 818727
2018-11-18 14:55:35.350 +02:00 [DBG] Start end session request validation
2018-11-18 14:55:35.350 +02:00 [DBG] Start identity token validation
2018-11-18 14:55:35.361 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:35.361 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 14:55:35.365 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 14:55:35.365 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 14:55:35.365 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542545731,
    "exp": 1542546031,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "b61f1ae904764892bd87131e17677577",
    "iat": 1542545731,
    "at_hash": "_jQg8e04JhD3mjrCJ-sHpw",
    "sid": "e4bdf2c8df31655fce9e476e000c857c",
    "sub": "818727",
    "auth_time": 1542545731,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 14:55:35.366 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDU3MzEsImV4cCI6MTU0MjU0NjAzMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJiNjFmMWFlOTA0NzY0ODkyYmQ4NzEzMWUxNzY3NzU3NyIsImlhdCI6MTU0MjU0NTczMSwiYXRfaGFzaCI6Il9qUWc4ZTA0SmhEM21qckNKLXNIcHciLCJzaWQiOiJlNGJkZjJjOGRmMzE2NTVmY2U5ZTQ3NmUwMDBjODU3YyIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0NTczMSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.NYMlOQLHC1_k2cPfmK-CoBxroSbvIC3-GijjRyWoO687S2nH43R8b_EWtZFF_l7sh-qsP5RiPr9O_-kIrucjjUtFEEAqLrJo3iwip9eu4D2mNKM1putv08Qu8tfdN2ecGdg3JcoNTd0ehK97KUeW8eN72j9snn4ICeNn9hvBS8THvNI63BWjnMjtga58A_ecY4vHWPVDzw8pBdLEVnvAPYSnQPqWycKFpCNO8yd_8ykEbwN8YR1viyghvt8tI-4qT1ZZNEu5zlMjGgY822sckS61HX0wnNtASGNVQvkUq_KKUfTf_6E16uLihOq0EdKJreTJTtd5pwlVe0SpLgeb5Q",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 14:55:35.366 +02:00 [DBG] Success validating end session request from spa
2018-11-18 14:55:35.404 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:35.404 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:35.411 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 14:55:35.411 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAK3P1FQB:0000000B",
  "TimeStamp": "2018-11-18T12:55:35Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:35.728 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 14:55:35.730 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 14:55:35.730 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 14:55:35.731 +02:00 [DBG] Processing signout callback request
2018-11-18 14:55:35.748 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:35.749 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 14:55:35.749 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 14:55:35.749 +02:00 [INF] Successful signout callback.
2018-11-18 14:55:35.749 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 14:55:35.749 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 14:55:41.846 +02:00 [INF] AuthenticationScheme: idsrv was challenged.
2018-11-18 14:55:43.849 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:55:43.851 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAK3P1FQB:00000010",
  "TimeStamp": "2018-11-18T12:55:43Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:43.851 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:43.851 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 14:55:43.852 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 14:55:43.852 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:43.879 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:43.879 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:43.921 +02:00 [DBG] 1 persisted grants found for 818727
2018-11-18 14:55:43.936 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:43.940 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:43.944 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:46.922 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:46.922 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:49.044 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:49.044 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:50.454 +02:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:55:50.456 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:50.457 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:50.471 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 14:55:50.471 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAK3P1FQB:00000014",
  "TimeStamp": "2018-11-18T12:55:50Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:54.081 +02:00 [INF] AuthenticationScheme: idsrv was challenged.
2018-11-18 14:55:55.581 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:55:55.583 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAK3P1FQB:00000018",
  "TimeStamp": "2018-11-18T12:55:55Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:55:55.584 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:55:55.584 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 14:55:55.584 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 14:55:55.584 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:55:55.603 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:55.603 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:55.608 +02:00 [DBG] 1 persisted grants found for 818727
2018-11-18 14:55:55.637 +02:00 [DBG] spa found in database: true
2018-11-18 14:55:55.642 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:55:55.649 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:55:58.853 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:55:58.853 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:56:00.038 +02:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:56:00.039 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:56:00.039 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:56:00.040 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 14:56:00.040 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAK3P1FQB:0000001B",
  "TimeStamp": "2018-11-18T12:56:00Z",
  "ProcessId": 10684,
  "LocalIpAddress": "127.0.0.1:26372",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:58:32.311 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 14:58:32.375 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 14:58:32.375 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 14:58:32.376 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 14:58:32.377 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 14:58:33.218 +02:00 [DBG] Starting token cleanup
2018-11-18 14:58:35.588 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:58:38.037 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:58:38.049 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:58:38.406 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:58:38.414 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:58:38.416 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:58:38.424 +02:00 [DBG] Start discovery request
2018-11-18 14:58:41.158 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:58:41.486 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 14:58:41.500 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 14:58:41.500 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 14:58:41.508 +02:00 [DBG] Start authorize request
2018-11-18 14:58:41.539 +02:00 [DBG] No user present in authorize request
2018-11-18 14:58:41.548 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:58:44.109 +02:00 [DBG] spa found in database: true
2018-11-18 14:58:44.426 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:58:47.549 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:58:48.228 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:58:49.607 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:58:49.628 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:58:49.722 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "c7d6589fd4044a849a41815be83e2068",
  "Nonce": "e7cd4bcd170e46f99222ee74f89f4207",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "c7d6589fd4044a849a41815be83e2068",
    "nonce": "e7cd4bcd170e46f99222ee74f89f4207"
  }
}
2018-11-18 14:58:49.756 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 14:58:52.548 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:58:53.820 +02:00 [DBG] spa found in database: true
2018-11-18 14:58:54.051 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:58:54.815 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:58:55.068 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:58:55.772 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:58:55.773 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:58:56.769 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:35.604 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 14:59:36.040 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:59:36.790 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:36.984 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:37.590 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:59:37.736 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:38.256 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:59:38.256 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:59:38.378 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAM5U0PER:00000005",
  "TimeStamp": "2018-11-18T12:59:38Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:59:38.405 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:59:38.409 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 14:59:38.409 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 14:59:38.513 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:59:39.597 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:39.675 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:59:39.677 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:59:39.677 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 14:59:39.678 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 14:59:39.678 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 14:59:39.714 +02:00 [DBG] Start authorize callback request
2018-11-18 14:59:39.729 +02:00 [DBG] User in authorize request: 818727
2018-11-18 14:59:39.730 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 14:59:40.449 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:40.565 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:40.948 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:59:41.066 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:41.396 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 14:59:41.397 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 14:59:41.397 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "c7d6589fd4044a849a41815be83e2068",
  "Nonce": "e7cd4bcd170e46f99222ee74f89f4207",
  "SessionId": "29313c3f6dfa8ad423a570a13cbdfe1d",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "c7d6589fd4044a849a41815be83e2068",
    "nonce": "e7cd4bcd170e46f99222ee74f89f4207"
  }
}
2018-11-18 14:59:41.399 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 14:59:41.605 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-18 14:59:41.633 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-18 14:59:41.645 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 14:59:41.661 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 14:59:41.663 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 14:59:41.670 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 14:59:41.674 +02:00 [DBG] Issued claims: []
2018-11-18 14:59:41.894 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 14:59:41.894 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 14:59:41.935 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****L2Rg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****nQHw"
    }
  ],
  "ActivityId": "0HLIDAM5U0PER:00000006",
  "TimeStamp": "2018-11-18T12:59:41Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 14:59:41.945 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "c7d6589fd4044a849a41815be83e2068",
  "Scope": "openid profile api1"
}
2018-11-18 14:59:41.995 +02:00 [DBG] Augmenting SignInContext
2018-11-18 14:59:41.996 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 14:59:43.695 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:59:44.160 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:59:44.161 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:59:44.161 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:59:44.161 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:59:44.161 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:59:44.161 +02:00 [DBG] Start discovery request
2018-11-18 14:59:44.761 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:59:44.807 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 14:59:44.911 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:59:44.911 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:59:44.911 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 14:59:44.912 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 14:59:44.912 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 14:59:44.919 +02:00 [DBG] Start key discovery request
2018-11-18 14:59:45.032 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:59:45.099 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:59:45.099 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:59:45.131 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 14:59:45.193 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:59:45.194 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:59:45.194 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 14:59:45.198 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 14:59:45.198 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 14:59:45.212 +02:00 [DBG] Start userinfo request
2018-11-18 14:59:45.218 +02:00 [DBG] Bearer token found in header
2018-11-18 14:59:45.878 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:46.406 +02:00 [DBG] spa found in database: true
2018-11-18 14:59:46.407 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 14:59:46.408 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 14:59:46.416 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542545981,
    "exp": 1542549581,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542545978,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 14:59:46.419 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 14:59:46.431 +02:00 [DBG] Creating userinfo response
2018-11-18 14:59:46.440 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:59:46.448 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:59:46.542 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:46.543 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 14:59:46.543 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 14:59:46.653 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 14:59:46.653 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 14:59:46.656 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 14:59:46.657 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 14:59:46.657 +02:00 [DBG] End userinfo request
2018-11-18 14:59:47.661 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 14:59:48.042 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 14:59:48.042 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 14:59:48.042 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 14:59:48.043 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 14:59:48.043 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 14:59:48.043 +02:00 [DBG] Start discovery request
2018-11-18 14:59:49.803 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 14:59:49.980 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:59:49.981 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 14:59:49.981 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 14:59:49.982 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 14:59:49.982 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 14:59:49.985 +02:00 [DBG] Rendering check session result
2018-11-18 15:00:25.056 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:00:25.058 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:00:25.059 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:00:25.059 +02:00 [DBG] Start discovery request
2018-11-18 15:00:25.515 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:00:25.979 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:00:25.980 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:00:25.980 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:00:25.981 +02:00 [DBG] Start key discovery request
2018-11-18 15:00:30.206 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:00:30.207 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:00:30.208 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 15:00:30.209 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 15:00:30.210 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 15:00:30.222 +02:00 [DBG] Processing signout request for 818727
2018-11-18 15:00:30.246 +02:00 [DBG] Start end session request validation
2018-11-18 15:00:30.280 +02:00 [DBG] Start identity token validation
2018-11-18 15:00:32.751 +02:00 [DBG] spa found in database: true
2018-11-18 15:00:32.751 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 15:00:32.756 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 15:00:32.756 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:00:32.757 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542545981,
    "exp": 1542546281,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "e7cd4bcd170e46f99222ee74f89f4207",
    "iat": 1542545981,
    "at_hash": "8T0fPdFDNucVvshIMAXHAQ",
    "sid": "29313c3f6dfa8ad423a570a13cbdfe1d",
    "sub": "818727",
    "auth_time": 1542545978,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 15:00:32.774 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDU5ODEsImV4cCI6MTU0MjU0NjI4MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJlN2NkNGJjZDE3MGU0NmY5OTIyMmVlNzRmODlmNDIwNyIsImlhdCI6MTU0MjU0NTk4MSwiYXRfaGFzaCI6IjhUMGZQZEZETnVjVnZzaElNQVhIQVEiLCJzaWQiOiIyOTMxM2MzZjZkZmE4YWQ0MjNhNTcwYTEzY2JkZmUxZCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0NTk3OCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.hxgWErEeuSwNT06bXDf1DDMIhohcgQhEUBmro3x9ft9e8hrrYLcWsfI7fbGxKctfVQPMeiXeD3-NheDmve21jm6D2gmHLo18s13Sw3M8JLYgfVPqfKvTt7wKNW16NzVsSw2LoYsXcfFj6jHrYwa7BuEfozsMc2sOnZdnI5KS9wDJTcpMbYpHC6q8pEbdddW0-W47K9MR7yXo4I4rI3ys3qJBjGg6_HLlkJ-xVqhPcekGWJf-OJ5_VyVaH_Hl-hOUEMBe74GnYwwRP-XTIcf1Yeq7up0O2p2qXFtZMvmtYJKA4byeGLug3ZxE5jq2nMj8_gmDl0QcXRV0G1WpwuL2Rg",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 15:00:32.774 +02:00 [DBG] Success validating end session request from spa
2018-11-18 15:00:32.821 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:00:32.822 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:00:33.029 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 15:00:33.041 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAM5U0PER:00000010",
  "TimeStamp": "2018-11-18T13:00:33Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:00:33.972 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 15:00:33.975 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 15:00:33.977 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 15:00:34.008 +02:00 [DBG] Processing signout callback request
2018-11-18 15:00:39.165 +02:00 [DBG] spa found in database: true
2018-11-18 15:00:39.165 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 15:00:39.165 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 15:00:39.165 +02:00 [INF] Successful signout callback.
2018-11-18 15:00:39.165 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 15:00:39.165 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 15:00:48.914 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:00:49.282 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:00:49.282 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:00:49.282 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:00:49.282 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:00:49.283 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:00:49.283 +02:00 [DBG] Start discovery request
2018-11-18 15:00:49.597 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:00:49.709 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 15:00:49.710 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 15:00:49.710 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 15:00:49.710 +02:00 [DBG] Start authorize request
2018-11-18 15:00:49.710 +02:00 [DBG] No user present in authorize request
2018-11-18 15:00:49.710 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:00:51.366 +02:00 [DBG] spa found in database: true
2018-11-18 15:00:51.733 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:00:52.177 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:00:52.262 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:00:52.906 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:00:52.906 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:00:52.907 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "f518123738bd495eb7f3f47091510b36",
  "Nonce": "d30e40c65e6e45b693e4f349489933a6",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "f518123738bd495eb7f3f47091510b36",
    "nonce": "d30e40c65e6e45b693e4f349489933a6"
  }
}
2018-11-18 15:00:52.907 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 15:00:53.045 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:00:54.312 +02:00 [DBG] spa found in database: true
2018-11-18 15:00:54.480 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:00:55.134 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:00:55.546 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:00:56.002 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:00:56.002 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:00:56.838 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:09.348 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:01:09.432 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:01:10.096 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:10.243 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:10.683 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:01:10.810 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:11.308 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:01:11.308 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:01:11.309 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAM5U0PER:00000014",
  "TimeStamp": "2018-11-18T13:01:11Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:01:11.309 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:01:11.309 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 15:01:11.309 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 15:01:11.309 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:01:11.995 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:12.012 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:12.012 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:12.013 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 15:01:12.014 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 15:01:12.014 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 15:01:12.014 +02:00 [DBG] Start authorize callback request
2018-11-18 15:01:12.014 +02:00 [DBG] User in authorize request: 818727
2018-11-18 15:01:12.015 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:01:12.557 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:12.692 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:13.043 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:01:13.136 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:13.488 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:01:13.488 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:01:13.489 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "f518123738bd495eb7f3f47091510b36",
  "Nonce": "d30e40c65e6e45b693e4f349489933a6",
  "SessionId": "12f68f833b133263ff1434c5cbae6454",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "f518123738bd495eb7f3f47091510b36",
    "nonce": "d30e40c65e6e45b693e4f349489933a6"
  }
}
2018-11-18 15:01:13.489 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 15:01:13.558 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: true
2018-11-18 15:01:13.566 +02:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-11-18 15:01:13.567 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 15:01:13.567 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 15:01:13.567 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 15:01:13.567 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 15:01:13.567 +02:00 [DBG] Issued claims: []
2018-11-18 15:01:13.573 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 15:01:13.573 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 15:01:13.580 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****S8tA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****d1ww"
    }
  ],
  "ActivityId": "0HLIDAM5U0PES:00000003",
  "TimeStamp": "2018-11-18T13:01:13Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:01:13.580 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "f518123738bd495eb7f3f47091510b36",
  "Scope": "openid profile api1"
}
2018-11-18 15:01:13.581 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:01:13.581 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:01:14.688 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:01:14.891 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:01:14.892 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:01:14.892 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:01:14.892 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:01:14.892 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:01:14.892 +02:00 [DBG] Start discovery request
2018-11-18 15:01:15.523 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:01:15.554 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 15:01:15.624 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:01:15.624 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:01:15.625 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:01:15.625 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:01:15.625 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:01:15.625 +02:00 [DBG] Start key discovery request
2018-11-18 15:01:15.718 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:01:15.779 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:01:15.779 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:01:15.818 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:01:15.895 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:01:15.895 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:01:15.896 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 15:01:15.896 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 15:01:15.896 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 15:01:15.896 +02:00 [DBG] Start userinfo request
2018-11-18 15:01:15.897 +02:00 [DBG] Bearer token found in header
2018-11-18 15:01:16.680 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:17.078 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:17.079 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 15:01:17.079 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:01:17.079 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542546073,
    "exp": 1542549673,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542546071,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 15:01:17.079 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 15:01:17.079 +02:00 [DBG] Creating userinfo response
2018-11-18 15:01:17.079 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:01:17.080 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:01:17.188 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:17.188 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 15:01:17.188 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:01:17.302 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:17.303 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 15:01:17.303 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 15:01:17.303 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 15:01:17.303 +02:00 [DBG] End userinfo request
2018-11-18 15:01:18.435 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:01:18.713 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:01:18.713 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:01:18.714 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:01:18.714 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:01:18.714 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:01:18.714 +02:00 [DBG] Start discovery request
2018-11-18 15:01:19.350 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:01:19.441 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:19.442 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:19.442 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 15:01:19.443 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 15:01:19.443 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 15:01:19.444 +02:00 [DBG] Rendering check session result
2018-11-18 15:01:36.840 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:36.840 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:36.840 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 15:01:36.845 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 15:01:36.845 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 15:01:36.846 +02:00 [DBG] Processing signout request for 818727
2018-11-18 15:01:36.847 +02:00 [DBG] Start end session request validation
2018-11-18 15:01:36.848 +02:00 [DBG] Start identity token validation
2018-11-18 15:01:37.740 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:37.740 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 15:01:37.744 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 15:01:37.744 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:01:37.745 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542546073,
    "exp": 1542546373,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "d30e40c65e6e45b693e4f349489933a6",
    "iat": 1542546073,
    "at_hash": "rGNfzNjInmi3d193_A_K0Q",
    "sid": "12f68f833b133263ff1434c5cbae6454",
    "sub": "818727",
    "auth_time": 1542546071,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 15:01:37.745 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDYwNzMsImV4cCI6MTU0MjU0NjM3MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJkMzBlNDBjNjVlNmU0NWI2OTNlNGYzNDk0ODk5MzNhNiIsImlhdCI6MTU0MjU0NjA3MywiYXRfaGFzaCI6InJHTmZ6TmpJbm1pM2QxOTNfQV9LMFEiLCJzaWQiOiIxMmY2OGY4MzNiMTMzMjYzZmYxNDM0YzVjYmFlNjQ1NCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0NjA3MSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.JrwXbMMDtW3ACHHiLLgeU8BA_yIY69s6j9wIwrfXl2UCy-fAR1eln2XYIsiNP-MveWXLN_IzAl5Va05G18vCBzomGX2z81Ts3F3Mcf1JU5n0-NNe2KVAbKZ7p9mtQ53gEYmE3gbMHib2gomWPEUfFzAXycQP13OtnNn-qkQrh6bLEQmewY8RKhg3dbdaf4HUlro9ThH-VO7byMwYu087cb7Y4xn94Eme4Tlau9jm5ndu6qFgF_sbfZFR6YHEH59P96IshnkLrd5lnb114PBwn1-6rCFQ-57YImHs8OEJAPV2-VMXxLwl97W85zBMWzFRWxw82llR1D3Kxzw4RoS8tA",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 15:01:37.745 +02:00 [DBG] Success validating end session request from spa
2018-11-18 15:01:37.839 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:37.839 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:37.934 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 15:01:37.934 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAM5U0PES:00000009",
  "TimeStamp": "2018-11-18T13:01:37Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:01:38.460 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 15:01:38.462 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 15:01:38.462 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 15:01:38.462 +02:00 [DBG] Processing signout callback request
2018-11-18 15:01:39.778 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:39.778 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 15:01:39.778 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 15:01:39.778 +02:00 [INF] Successful signout callback.
2018-11-18 15:01:39.778 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 15:01:39.778 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 15:01:49.526 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:01:49.531 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:01:49.532 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:01:49.532 +02:00 [DBG] Start discovery request
2018-11-18 15:01:50.591 +02:00 [INF] AuthenticationScheme: idsrv was challenged.
2018-11-18 15:01:52.070 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:01:52.815 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:01:52.962 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDAM5U0PET:00000003",
  "TimeStamp": "2018-11-18T13:01:52Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:01:52.963 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:01:52.963 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 15:01:52.963 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 15:01:52.963 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:01:53.008 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:53.008 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:01:53.246 +02:00 [DBG] 1 persisted grants found for 818727
2018-11-18 15:01:56.788 +02:00 [DBG] spa found in database: true
2018-11-18 15:01:57.139 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:01:59.294 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:02:02.811 +02:00 [DBG] CORS request made for path: /grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:02:02.812 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:02.812 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:03.218 +02:00 [DBG] removing 1 persisted grants from database for subject 818727, clientId spa
2018-11-18 15:02:03.787 +02:00 [INF] {
  "Name": "Grants revoked",
  "Category": "Grants",
  "EventType": "Information",
  "Id": 4002,
  "SubjectId": "818727",
  "ClientId": "spa",
  "ActivityId": "0HLIDAM5U0PET:00000004",
  "TimeStamp": "2018-11-18T13:02:03Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:02:03.857 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:03.857 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:04.109 +02:00 [DBG] 0 persisted grants found for 818727
2018-11-18 15:02:07.163 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:07.164 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:08.671 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:08.671 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:10.052 +02:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:02:10.054 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:10.054 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:02:10.145 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 15:02:10.146 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDAM5U0PET:00000006",
  "TimeStamp": "2018-11-18T13:02:10Z",
  "ProcessId": 13300,
  "LocalIpAddress": "127.0.0.1:22739",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:18:21.101 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:18:21.157 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:18:21.158 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:18:21.159 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:18:21.159 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:18:21.924 +02:00 [DBG] Starting token cleanup
2018-11-18 15:19:18.772 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:19:20.918 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:19:20.923 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:19:21.092 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:19:21.099 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:19:21.100 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:19:21.107 +02:00 [DBG] Start discovery request
2018-11-18 15:19:22.510 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:19:22.722 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 15:19:22.736 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 15:19:22.736 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 15:19:22.748 +02:00 [DBG] Start authorize request
2018-11-18 15:19:22.775 +02:00 [DBG] No user present in authorize request
2018-11-18 15:19:22.792 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:19:23.900 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:24.052 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:24.383 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:24.492 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:24.698 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:24.714 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:19:24.755 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "107fdb13f1c3463c9561b315ff62a23b",
  "Nonce": "4d851b03e5d041e4925ddac75ae92de7",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "107fdb13f1c3463c9561b315ff62a23b",
    "nonce": "4d851b03e5d041e4925ddac75ae92de7"
  }
}
2018-11-18 15:19:24.770 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 15:19:25.654 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:19:26.340 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:26.454 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:26.708 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:26.814 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:27.071 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:27.071 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:19:27.581 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:42.752 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:19:43.037 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:19:43.934 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:44.109 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:44.636 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:44.767 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:45.165 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:45.166 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:19:45.234 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDB186A5EV:00000005",
  "TimeStamp": "2018-11-18T13:19:45Z",
  "ProcessId": 14780,
  "LocalIpAddress": "127.0.0.1:29144",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:19:45.283 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:19:45.289 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 15:19:45.289 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 15:19:45.385 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:19:46.041 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:46.088 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:19:46.090 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:19:46.090 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 15:19:46.091 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 15:19:46.092 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 15:19:46.100 +02:00 [DBG] Start authorize callback request
2018-11-18 15:19:46.108 +02:00 [DBG] User in authorize request: 818727
2018-11-18 15:19:46.109 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:19:46.587 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:46.661 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:46.979 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:47.090 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:47.528 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:47.528 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:19:47.528 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "107fdb13f1c3463c9561b315ff62a23b",
  "Nonce": "4d851b03e5d041e4925ddac75ae92de7",
  "SessionId": "91d1cc67c326f12b2d20697be28ff578",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "107fdb13f1c3463c9561b315ff62a23b",
    "nonce": "4d851b03e5d041e4925ddac75ae92de7"
  }
}
2018-11-18 15:19:47.531 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 15:19:47.675 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-18 15:19:47.675 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-18 15:19:47.676 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-18 15:19:47.676 +02:00 [INF] Showing consent: User has not yet consented
2018-11-18 15:19:47.699 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:19:47.699 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:19:47.817 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:19:48.438 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:48.553 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:48.903 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:49.060 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:49.328 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:49.329 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:19:49.782 +02:00 [DBG] spa found in database: true
2018-11-18 15:19:49.889 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:19:50.145 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:19:51.199 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:19:51.199 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:35.835 +02:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:21:35.849 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:35.849 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:35.962 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:21:36.697 +02:00 [DBG] spa found in database: true
2018-11-18 15:21:36.815 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:37.276 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:21:37.414 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:37.898 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:21:37.899 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:21:37.915 +02:00 [INF] {
  "Name": "Consent granted",
  "Category": "Grants",
  "EventType": "Information",
  "Id": 4000,
  "SubjectId": "818727",
  "ClientId": "spa",
  "RequestedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "GrantedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ConsentRemembered": true,
  "ActivityId": "0HLIDB186A5F0:00000001",
  "TimeStamp": "2018-11-18T13:21:37Z",
  "ProcessId": 14780,
  "LocalIpAddress": "127.0.0.1:29144",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:21:38.548 +02:00 [DBG] spa found in database: true
2018-11-18 15:21:38.575 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:38.575 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:38.576 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 15:21:38.577 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 15:21:38.577 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 15:21:38.578 +02:00 [DBG] Start authorize callback request
2018-11-18 15:21:38.642 +02:00 [DBG] User in authorize request: 818727
2018-11-18 15:21:38.643 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:21:39.065 +02:00 [DBG] spa found in database: true
2018-11-18 15:21:39.185 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:39.595 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:21:39.731 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:40.095 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:21:40.095 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:21:40.096 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "107fdb13f1c3463c9561b315ff62a23b",
  "Nonce": "4d851b03e5d041e4925ddac75ae92de7",
  "SessionId": "91d1cc67c326f12b2d20697be28ff578",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "107fdb13f1c3463c9561b315ff62a23b",
    "nonce": "4d851b03e5d041e4925ddac75ae92de7"
  }
}
2018-11-18 15:21:40.096 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 15:21:40.158 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-18 15:21:40.159 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-18 15:21:40.159 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-18 15:21:40.172 +02:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-11-18 15:21:40.175 +02:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-11-18 15:21:40.182 +02:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2018-11-18 15:21:40.268 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= not found in database
2018-11-18 15:21:40.840 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 15:21:40.872 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 15:21:40.873 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 15:21:40.884 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 15:21:40.887 +02:00 [DBG] Issued claims: []
2018-11-18 15:21:41.078 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 15:21:41.079 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 15:21:41.109 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****3TOw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****li-w"
    }
  ],
  "ActivityId": "0HLIDB186A5F0:00000002",
  "TimeStamp": "2018-11-18T13:21:41Z",
  "ProcessId": 14780,
  "LocalIpAddress": "127.0.0.1:29144",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:21:41.120 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "107fdb13f1c3463c9561b315ff62a23b",
  "Scope": "openid profile api1"
}
2018-11-18 15:21:41.172 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:21:41.174 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:21:41.656 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:21:41.775 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:21:41.775 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:21:41.775 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:21:41.776 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:21:41.776 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:21:41.776 +02:00 [DBG] Start discovery request
2018-11-18 15:21:42.537 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:21:42.558 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 15:21:42.604 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:21:42.604 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:21:42.604 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:21:42.605 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:21:42.605 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:21:42.612 +02:00 [DBG] Start key discovery request
2018-11-18 15:21:42.719 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:21:42.774 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:21:42.774 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:21:42.797 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:21:42.836 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:21:42.837 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:21:42.837 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 15:21:42.841 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 15:21:42.842 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 15:21:42.856 +02:00 [DBG] Start userinfo request
2018-11-18 15:21:42.863 +02:00 [DBG] Bearer token found in header
2018-11-18 15:21:43.597 +02:00 [DBG] spa found in database: true
2018-11-18 15:21:44.068 +02:00 [DBG] spa found in database: true
2018-11-18 15:21:44.070 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 15:21:44.070 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:21:44.077 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542547300,
    "exp": 1542550900,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542547185,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 15:21:44.080 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 15:21:44.091 +02:00 [DBG] Creating userinfo response
2018-11-18 15:21:44.100 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:21:44.105 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:21:44.263 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:44.265 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 15:21:44.265 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:21:44.342 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:21:44.342 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 15:21:44.352 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 15:21:44.353 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 15:21:44.354 +02:00 [DBG] End userinfo request
2018-11-18 15:21:44.699 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:21:44.752 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:21:44.752 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:21:44.753 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:21:44.753 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:21:44.753 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:21:44.753 +02:00 [DBG] Start discovery request
2018-11-18 15:21:45.378 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:21:45.449 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:45.450 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:21:45.450 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 15:21:45.450 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 15:21:45.451 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 15:21:45.452 +02:00 [DBG] Rendering check session result
2018-11-18 15:22:29.629 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:22:29.629 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:22:29.629 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:22:29.630 +02:00 [DBG] Start discovery request
2018-11-18 15:22:29.986 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:22:30.224 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:22:30.224 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:22:30.224 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:22:30.224 +02:00 [DBG] Start key discovery request
2018-11-18 15:22:32.766 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:22:32.766 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:22:32.766 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 15:22:32.769 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 15:22:32.769 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 15:22:32.786 +02:00 [DBG] Processing signout request for 818727
2018-11-18 15:22:32.807 +02:00 [DBG] Start end session request validation
2018-11-18 15:22:32.823 +02:00 [DBG] Start identity token validation
2018-11-18 15:22:33.362 +02:00 [DBG] spa found in database: true
2018-11-18 15:22:33.362 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 15:22:33.371 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 15:22:33.371 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:22:33.372 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542547301,
    "exp": 1542547601,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "4d851b03e5d041e4925ddac75ae92de7",
    "iat": 1542547301,
    "at_hash": "YN7rNuw2SzOJSfgRdiPt_A",
    "sid": "91d1cc67c326f12b2d20697be28ff578",
    "sub": "818727",
    "auth_time": 1542547185,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 15:22:33.384 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDczMDEsImV4cCI6MTU0MjU0NzYwMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiI0ZDg1MWIwM2U1ZDA0MWU0OTI1ZGRhYzc1YWU5MmRlNyIsImlhdCI6MTU0MjU0NzMwMSwiYXRfaGFzaCI6IllON3JOdXcyU3pPSlNmZ1JkaVB0X0EiLCJzaWQiOiI5MWQxY2M2N2MzMjZmMTJiMmQyMDY5N2JlMjhmZjU3OCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0NzE4NSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.IMpgocxr3fPOFIwVcYqTe4AOq-0MPRJ9hcDNWQSU2S3Xh_KebVR9zyY-yjItRySAYmgtZbiqBTUC3jyysDpDmP0rBMVye_wnyM5Fe4lDLNrHOC9I6_C314LpcEUA1kKRnsmwrL_DJjAfFWLMp-ANrhVAbj-JQDENX3Ypxc_n8VU2nfuqny8j8GUX8wOgTtNasXWgzD1w0vVmrgyBaNh-AMo3zMhrx5fEfJnLTdpfkvNBHaDqbXnolHWYqoo_OXEwk0qs0p46bnZBaey43lAd5hbh1ejeWa431rrxo8Z0Pi23r3IM4cd1hfOD-DPJux9YywJRRm8UopzpuA6UIl3TOw",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 15:22:33.385 +02:00 [DBG] Success validating end session request from spa
2018-11-18 15:22:33.434 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:22:33.434 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:22:33.541 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 15:22:33.552 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDB186A5F1:00000006",
  "TimeStamp": "2018-11-18T13:22:33Z",
  "ProcessId": 14780,
  "LocalIpAddress": "127.0.0.1:29144",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:22:34.262 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 15:22:34.271 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 15:22:34.271 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 15:22:34.286 +02:00 [DBG] Processing signout callback request
2018-11-18 15:22:35.272 +02:00 [DBG] spa found in database: true
2018-11-18 15:22:35.272 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 15:22:35.272 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 15:22:35.272 +02:00 [INF] Successful signout callback.
2018-11-18 15:22:35.272 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 15:22:35.272 +02:00 [DBG] No client back-channel iframe urls
2018-11-18 15:25:17.075 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:25:17.110 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:25:17.111 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:25:17.111 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:25:17.111 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:25:44.791 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:25:44.828 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:25:44.828 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:25:44.828 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:25:44.828 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:26:10.955 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:26:10.991 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:26:10.992 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:26:10.992 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:26:10.993 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:26:37.584 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:26:37.624 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:26:37.624 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:26:37.624 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:26:37.625 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:26:55.723 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:26:55.768 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:26:55.769 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:26:55.769 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:26:55.769 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:28:17.934 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:28:17.970 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:28:17.971 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:28:17.971 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:28:17.971 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:28:38.751 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:28:38.788 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:28:38.788 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:28:38.789 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:28:38.789 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:30:05.602 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:30:05.639 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:30:05.639 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:30:05.640 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:30:05.640 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:31:09.839 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:31:09.877 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:31:09.877 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:31:09.877 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:31:09.878 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:31:33.980 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:31:34.017 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:31:34.017 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:31:34.017 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:31:34.018 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:34:25.116 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:34:25.160 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:34:25.160 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:34:25.161 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:34:25.161 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:34:25.559 +02:00 [WRN] Unable to bind to http://localhost:5000 on the IPv4 loopback interface: 'Error -4092 EACCES permission denied'.
2018-11-18 15:34:25.562 +02:00 [WRN] Unable to bind to http://localhost:5000 on the IPv6 loopback interface: 'Error -4092 EACCES permission denied'.
2018-11-18 15:34:25.570 +02:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://localhost:5000. ---> System.AggregateException: One or more errors occurred. (Error -4092 EACCES permission denied) (Error -4092 EACCES permission denied) ---> Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException: Error -4092 EACCES permission denied
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.LibuvFunctions.ThrowError(Int32 statusCode)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvTcpHandle.Bind(IPEndPoint endPoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.ListenTcp(Boolean useFileHandle)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.<>c.<StartAsync>b__8_0(Listener listener)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.LibuvThread.DoPostWork()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.ListenerPrimary.StartAsync(String pipeName, Byte[] pipeMessage, IEndPointInformation endPointInformation, LibuvThread thread)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass23_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAddressAsync(String address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, List`1 listenOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2018-11-18 15:34:25.668 +02:00 [FTL] An error occurred stopping the application
System.AggregateException: One or more errors occurred. (Not started. Call Start first.) ---> System.InvalidOperationException: Not started. Call Start first.
   at IdentityServer4.EntityFramework.TokenCleanup.Stop() in C:\local\identity\server4\EntityFramework\src\IdentityServer4.EntityFramework\TokenCleanup.cs:line 59
   at Microsoft.Extensions.DependencyInjection.IdentityServerEntityFrameworkBuilderExtensions.TokenCleanupHost.StopAsync(CancellationToken cancellationToken) in C:\local\identity\server4\EntityFramework\src\IdentityServer4.EntityFramework\Extensions\IdentityServerEntityFrameworkBuilderExtensions.cs:line 167
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.StopAsync(CancellationToken token)
---> (Inner Exception #0) System.InvalidOperationException: Not started. Call Start first.
   at IdentityServer4.EntityFramework.TokenCleanup.Stop() in C:\local\identity\server4\EntityFramework\src\IdentityServer4.EntityFramework\TokenCleanup.cs:line 59
   at Microsoft.Extensions.DependencyInjection.IdentityServerEntityFrameworkBuilderExtensions.TokenCleanupHost.StopAsync(CancellationToken cancellationToken) in C:\local\identity\server4\EntityFramework\src\IdentityServer4.EntityFramework\Extensions\IdentityServerEntityFrameworkBuilderExtensions.cs:line 167
   at Microsoft.AspNetCore.Hosting.Internal.HostedServiceExecutor.ExecuteAsync(Func`2 callback)<---

2018-11-18 15:38:43.446 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:38:43.491 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:38:43.495 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:38:43.496 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:38:43.497 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:42:05.805 +02:00 [DBG] Using idsrv as default scheme for authentication
2018-11-18 15:42:05.874 +02:00 [DBG] Using idsrv as default scheme for sign-in
2018-11-18 15:42:05.875 +02:00 [DBG] Using idsrv as default scheme for sign-out
2018-11-18 15:42:05.876 +02:00 [DBG] Using idsrv as default scheme for challenge
2018-11-18 15:42:05.876 +02:00 [DBG] Using idsrv as default scheme for forbid
2018-11-18 15:42:06.566 +02:00 [DBG] Starting token cleanup
2018-11-18 15:42:19.041 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:42:21.539 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:42:21.546 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:42:21.707 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:42:21.713 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:42:21.714 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:42:21.720 +02:00 [DBG] Start discovery request
2018-11-18 15:42:23.059 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:42:23.301 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-11-18 15:42:23.345 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-11-18 15:42:23.346 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-11-18 15:42:23.405 +02:00 [DBG] Start authorize request
2018-11-18 15:42:23.438 +02:00 [DBG] No user present in authorize request
2018-11-18 15:42:23.449 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:42:24.862 +02:00 [DBG] spa found in database: true
2018-11-18 15:42:25.025 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:42:25.422 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:42:25.559 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:42:25.780 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:42:25.794 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:42:25.832 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e32c72f0262749c3bcf9011242c762ee",
  "Nonce": "261912bdf4234d92b9da3589f27f60b0",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e32c72f0262749c3bcf9011242c762ee",
    "nonce": "261912bdf4234d92b9da3589f27f60b0"
  }
}
2018-11-18 15:42:25.852 +02:00 [INF] Showing login: User is not authenticated
2018-11-18 15:42:27.427 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:42:28.345 +02:00 [DBG] spa found in database: true
2018-11-18 15:42:28.455 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:42:28.709 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:42:28.842 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:42:29.214 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:42:29.214 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:42:29.734 +02:00 [DBG] spa found in database: true
2018-11-18 15:42:58.782 +02:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:42:59.053 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:42:59.675 +02:00 [DBG] spa found in database: true
2018-11-18 15:42:59.787 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:00.121 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:00.229 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:00.539 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:00.539 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:43:00.625 +02:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLIDBEGNIV6O:00000004",
  "TimeStamp": "2018-11-18T13:43:00Z",
  "ProcessId": 14724,
  "LocalIpAddress": "127.0.0.1:21985",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:43:00.661 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:43:00.666 +02:00 [DBG] Adding idp claim with value: local
2018-11-18 15:43:00.666 +02:00 [DBG] Adding amr claim with value: pwd
2018-11-18 15:43:00.764 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:43:01.299 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:01.367 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:01.369 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:01.369 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 15:43:01.371 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 15:43:01.371 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 15:43:01.393 +02:00 [DBG] Start authorize callback request
2018-11-18 15:43:01.411 +02:00 [DBG] User in authorize request: 818727
2018-11-18 15:43:01.412 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:43:01.810 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:01.882 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:02.057 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:02.153 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:02.436 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:02.437 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:43:02.437 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e32c72f0262749c3bcf9011242c762ee",
  "Nonce": "261912bdf4234d92b9da3589f27f60b0",
  "SessionId": "0505db85b6f46537c785f3f3c30521fc",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e32c72f0262749c3bcf9011242c762ee",
    "nonce": "261912bdf4234d92b9da3589f27f60b0"
  }
}
2018-11-18 15:43:02.439 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 15:43:02.598 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-18 15:43:02.598 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-18 15:43:02.599 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-18 15:43:02.599 +02:00 [INF] Showing consent: User has not yet consented
2018-11-18 15:43:02.623 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:02.623 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:02.807 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:43:03.479 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:03.586 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:03.891 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:03.996 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:04.364 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:04.365 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:43:04.809 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:04.898 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:05.144 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:06.310 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:06.310 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:10.184 +02:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-11-18 15:43:10.185 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:10.185 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:10.303 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:43:10.884 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:11.000 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:11.277 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:11.395 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:11.872 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:11.873 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:43:11.885 +02:00 [INF] {
  "Name": "Consent granted",
  "Category": "Grants",
  "EventType": "Information",
  "Id": 4000,
  "SubjectId": "818727",
  "ClientId": "spa",
  "RequestedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "GrantedScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ConsentRemembered": true,
  "ActivityId": "0HLIDBEGNIV6O:00000006",
  "TimeStamp": "2018-11-18T13:43:11Z",
  "ProcessId": 14724,
  "LocalIpAddress": "127.0.0.1:21985",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:43:12.403 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:12.418 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:12.418 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:12.419 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-11-18 15:43:12.419 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-11-18 15:43:12.420 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-11-18 15:43:12.420 +02:00 [DBG] Start authorize callback request
2018-11-18 15:43:12.519 +02:00 [DBG] User in authorize request: 818727
2018-11-18 15:43:12.519 +02:00 [DBG] Start authorize request protocol validation
2018-11-18 15:43:12.940 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:13.018 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:13.223 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:13.299 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:13.528 +02:00 [DBG] Found ["api1"] API scopes in database
2018-11-18 15:43:13.529 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-11-18 15:43:13.529 +02:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "AllowedRedirectUris": [
    "http://localhost:5002/callback.html",
    "http://localhost:5002/index.html",
    "http://localhost:5002/silent.html",
    "http://localhost:5002/popup.html"
  ],
  "SubjectId": "818727",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "e32c72f0262749c3bcf9011242c762ee",
  "Nonce": "261912bdf4234d92b9da3589f27f60b0",
  "SessionId": "0505db85b6f46537c785f3f3c30521fc",
  "Raw": {
    "client_id": "spa",
    "redirect_uri": "http://localhost:5002/callback.html",
    "response_type": "id_token token",
    "scope": "openid profile api1",
    "state": "e32c72f0262749c3bcf9011242c762ee",
    "nonce": "261912bdf4234d92b9da3589f27f60b0"
  }
}
2018-11-18 15:43:13.530 +02:00 [DBG] IsActive called from: AuthorizeEndpoint
2018-11-18 15:43:13.607 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= found in database: false
2018-11-18 15:43:13.608 +02:00 [DBG] user_consent grant with value: spa|818727 not found in store.
2018-11-18 15:43:13.608 +02:00 [DBG] Found no prior consent from consent store, consent is required
2018-11-18 15:43:13.624 +02:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-11-18 15:43:13.627 +02:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-11-18 15:43:13.636 +02:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2018-11-18 15:43:13.719 +02:00 [DBG] b3hu0okmcq3jUle30FnDFZMCDEuAXDFht+uStSTPgIE= not found in database
2018-11-18 15:43:14.010 +02:00 [DBG] Creating Implicit Flow response.
2018-11-18 15:43:14.035 +02:00 [DBG] Getting claims for access token for client: spa
2018-11-18 15:43:14.036 +02:00 [DBG] Getting claims for access token for subject: 818727
2018-11-18 15:43:14.042 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types [] via ClaimsProviderAccessToken
2018-11-18 15:43:14.045 +02:00 [DBG] Issued claims: []
2018-11-18 15:43:14.167 +02:00 [DBG] Getting claims for identity token for subject: 818727 and client: spa
2018-11-18 15:43:14.167 +02:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-11-18 15:43:14.188 +02:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "RedirectUri": "http://localhost:5002/callback.html",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****I_vQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****8ypw"
    }
  ],
  "ActivityId": "0HLIDBEGNIV6P:00000005",
  "TimeStamp": "2018-11-18T13:43:14Z",
  "ProcessId": 14724,
  "LocalIpAddress": "127.0.0.1:21985",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:43:14.197 +02:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:5002/callback.html",
  "State": "e32c72f0262749c3bcf9011242c762ee",
  "Scope": "openid profile api1"
}
2018-11-18 15:43:14.237 +02:00 [DBG] Augmenting SignInContext
2018-11-18 15:43:14.238 +02:00 [INF] AuthenticationScheme: idsrv signed in.
2018-11-18 15:43:15.183 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:43:15.225 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:43:15.225 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:43:15.226 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:43:15.226 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:43:15.226 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:43:15.226 +02:00 [DBG] Start discovery request
2018-11-18 15:43:15.801 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:43:15.872 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5002
2018-11-18 15:43:15.916 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:43:15.916 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:43:15.917 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:43:15.917 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:43:15.917 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:43:15.925 +02:00 [DBG] Start key discovery request
2018-11-18 15:43:16.019 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:43:16.056 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:43:16.056 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:43:16.099 +02:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:5002
2018-11-18 15:43:16.166 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:43:16.167 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:43:16.167 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-11-18 15:43:16.172 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-11-18 15:43:16.172 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-11-18 15:43:16.186 +02:00 [DBG] Start userinfo request
2018-11-18 15:43:16.192 +02:00 [DBG] Bearer token found in header
2018-11-18 15:43:16.849 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:17.376 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:17.378 +02:00 [DBG] IsActive called from: AccessTokenValidation
2018-11-18 15:43:17.378 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:43:17.385 +02:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1542548594,
    "exp": 1542552194,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "spa",
    "sub": "818727",
    "auth_time": 1542548580,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-11-18 15:43:17.387 +02:00 [DBG] IsActive called from: UserInfoRequestValidation
2018-11-18 15:43:17.398 +02:00 [DBG] Creating userinfo response
2018-11-18 15:43:17.405 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:43:17.409 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:43:17.483 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:17.484 +02:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-11-18 15:43:17.484 +02:00 [DBG] Scopes in access token: openid profile api1
2018-11-18 15:43:17.551 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-11-18 15:43:17.551 +02:00 [DBG] Get profile called for subject 818727 from client Depo web spa client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2018-11-18 15:43:17.554 +02:00 [DBG] Issued claims: ["name","given_name","family_name","website"]
2018-11-18 15:43:17.555 +02:00 [INF] Profile service returned to the following claim types: name given_name family_name website
2018-11-18 15:43:17.555 +02:00 [DBG] End userinfo request
2018-11-18 15:43:17.626 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:17.629 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:17.629 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 15:43:17.630 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 15:43:17.630 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 15:43:17.633 +02:00 [DBG] Rendering check session result
2018-11-18 15:43:18.388 +02:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5002
2018-11-18 15:43:18.445 +02:00 [DBG] Origin http://localhost:5002 is allowed: true
2018-11-18 15:43:18.445 +02:00 [DBG] CorsPolicyService allowed origin: http://localhost:5002
2018-11-18 15:43:18.445 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:43:18.446 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:43:18.446 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:43:18.446 +02:00 [DBG] Start discovery request
2018-11-18 15:43:18.998 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:43:19.170 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:19.170 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:19.171 +02:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2018-11-18 15:43:19.171 +02:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2018-11-18 15:43:19.172 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2018-11-18 15:43:19.172 +02:00 [DBG] Rendering check session result
2018-11-18 15:43:20.353 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-11-18 15:43:20.355 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-11-18 15:43:20.355 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-11-18 15:43:20.355 +02:00 [DBG] Start discovery request
2018-11-18 15:43:20.586 +02:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-11-18 15:43:20.747 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-11-18 15:43:20.747 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-11-18 15:43:20.747 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-11-18 15:43:20.748 +02:00 [DBG] Start key discovery request
2018-11-18 15:43:24.550 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:24.560 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:24.560 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-11-18 15:43:24.564 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-11-18 15:43:24.564 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-11-18 15:43:24.577 +02:00 [DBG] Processing signout request for 818727
2018-11-18 15:43:24.609 +02:00 [DBG] Start end session request validation
2018-11-18 15:43:24.627 +02:00 [DBG] Start identity token validation
2018-11-18 15:43:24.987 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:24.987 +02:00 [DBG] Client found: spa / Depo web spa client
2018-11-18 15:43:24.991 +02:00 [DBG] IsActive called from: IdentityTokenValidation
2018-11-18 15:43:24.992 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-11-18 15:43:24.992 +02:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1542548594,
    "exp": 1542548894,
    "iss": "http://localhost:5000",
    "aud": "spa",
    "nonce": "261912bdf4234d92b9da3589f27f60b0",
    "iat": 1542548594,
    "at_hash": "_tlkmRvwXqc6mG0nGS8lmg",
    "sid": "0505db85b6f46537c785f3f3c30521fc",
    "sub": "818727",
    "auth_time": 1542548580,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-11-18 15:43:25.006 +02:00 [INF] End session request validation success
{
  "ClientId": "spa",
  "ClientName": "Depo web spa client",
  "SubjectId": "818727",
  "PostLogOutUri": "http://localhost:5002/index.html",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjViNjgwMjI5OTcxNDBhMmYzNDc0Y2FmNWMxNTRmMmY4IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NDI1NDg1OTQsImV4cCI6MTU0MjU0ODg5NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiIyNjE5MTJiZGY0MjM0ZDkyYjlkYTM1ODlmMjdmNjBiMCIsImlhdCI6MTU0MjU0ODU5NCwiYXRfaGFzaCI6Il90bGttUnZ3WHFjNm1HMG5HUzhsbWciLCJzaWQiOiIwNTA1ZGI4NWI2ZjQ2NTM3Yzc4NWYzZjNjMzA1MjFmYyIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTU0MjU0ODU4MCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.Cuf53WT5Gpf27dPSmTVLaqZ2KhNDL7JLvAMjhM_hz792yBU3sQTg2AoncGlfhSu_F6gAFa1Uf06ugDqlhqc4Z1aa66mJfBuhwKL5fFVWnhrLa4Ec-h4o9Q3d87iPR1FdWM6HRwyf4tfJ5zL2YMh4INAZlilDkC77M9fOGLaSKYkyTCOKcQ88mmz-kbroBUUDFc0hHgctDYibvZ33wM7PKLTVJgV9XL1zyFgLAbORdphpNRRmWcQFH9a71Ju-0fhBiPkOyzk1nP9NAJ63c4ipwR_4zouZsB2r92wYxhikH7OQE0VLF08LU74QZxqt6pXgrdJl7fEutIZxMDEGtLI_vQ",
    "post_logout_redirect_uri": "http://localhost:5002/index.html"
  }
}
2018-11-18 15:43:25.006 +02:00 [DBG] Success validating end session request from spa
2018-11-18 15:43:25.044 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:25.044 +02:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-11-18 15:43:25.201 +02:00 [INF] AuthenticationScheme: idsrv signed out.
2018-11-18 15:43:25.209 +02:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HLIDBEGNIV6O:0000000C",
  "TimeStamp": "2018-11-18T13:43:25Z",
  "ProcessId": 14724,
  "LocalIpAddress": "127.0.0.1:21985",
  "RemoteIpAddress": "::1"
}
2018-11-18 15:43:25.970 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-11-18 15:43:25.972 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-11-18 15:43:25.977 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-11-18 15:43:25.988 +02:00 [DBG] Processing signout callback request
2018-11-18 15:43:26.896 +02:00 [DBG] spa found in database: true
2018-11-18 15:43:26.897 +02:00 [DBG] No client front-channel logout URLs
2018-11-18 15:43:26.897 +02:00 [DBG] No client back-channel logout URLs
2018-11-18 15:43:26.897 +02:00 [INF] Successful signout callback.
2018-11-18 15:43:26.897 +02:00 [DBG] No client front-channel iframe urls
2018-11-18 15:43:26.897 +02:00 [DBG] No client back-channel iframe urls
